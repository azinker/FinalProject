'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:CartCtrl
 * @description
 * # CartCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('CartCtrl', function ($scope, cart) {
    $scope.cart = cart;
    console.log(cart);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:CategoryCtrl
 * @description
 * # CategoryCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('CategoryCtrl', function ($scope, category, products) {
    $scope.category = category;
    $scope.products = products;
    console.log(products);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:CheckoutCtrl
 * @description
 * # CheckoutCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('CheckoutCtrl', function ($scope, $rootScope, $location, moltin, cart, options, fields) {
    $scope.data = {bill: {}, ship: {}, ship_bill: 0, notes: '', shipping: 'free_shipping', gateway: 'stripe'}
    $scope.cart = cart;
    $scope.options = options;
    $scope.fields = fields;

    $scope.createOrder = function() {
      moltin.Cart.Complete({
        customer: '1069796748437750328', //guest customer for now
        shipping: $scope.data.shipping,
        gateway: $scope.data.gateway,
        bill_to: $scope.data.bill,
        ship_to: $scope.data.ship_bill ? 'bill_to' : $scope.data.ship
      }, function(response) {
        $rootScope.order = response;
        $rootScope.$apply(function() {
          $location.path('/payment');
        });
      })
    }
    console.log(cart);
    console.log(options);
    console.log(fields);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:CompleteCtrl
 * @description
 * # CompleteCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('CompleteCtrl', function ($scope) {
    $scope.awesomeThings = [
      'HTML5 Boilerplate',
      'AngularJS',
      'Karma'
    ];
    console.log($scope);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:MainCtrl
 * @description
 * # MainCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('MainCtrl', function ($scope, categories, features) {
    $scope.categories = categories;
    $scope.features = features;
    console.log(features);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:PaymentCtrl
 * @description
 * # PaymentCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('PaymentCtrl', function ($scope, $location, $rootScope, moltin) {
    $scope.payment = function(data) {
      moltin.Checkout.Payment('purchase', $scope.order.id, {data: $scope.data}, function(response) {
        $rootScope.order = $rootScope.cart = null;
        $rootScope.payment = response;
        $rootScope.$apply(function() {
          $location.path('/complete');
        });
      });
    }
    console.log($rootScope);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:ProductCtrl
 * @description
 * # ProductCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('ProductCtrl', function ($scope, $rootScope, product, moltin, $timeout) {
    $scope.product = product;
    $scope.addStatus = null;

    $scope.addCart = function() {
      $scope.addStatus = 'Adding to cart...';
      // Insert(id, qty, modifiers/size, callback)
      moltin.Cart.Insert(product.id, 1, null, function(cart) {
        $scope.addStatus = 'Success!';
        moltin.Cart.Contents(function(items) {
          $rootScope.cart = items;
          $rootScope.$apply();
        });
        $scope.$apply();
        $timeout(function() {
          $scope.addStatus = null;
        }, 1000);
      });
    }
    console.log(product);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:CartCtrl
 * @description
 * # CartCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('CartCtrl', function ($scope, cart) {
    $scope.cart = cart;
    console.log(cart);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:CategoryCtrl
 * @description
 * # CategoryCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('CategoryCtrl', function ($scope, category, products) {
    $scope.category = category;
    $scope.products = products;
    console.log(products);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:CheckoutCtrl
 * @description
 * # CheckoutCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('CheckoutCtrl', function ($scope, $rootScope, $location, moltin, cart, options, fields) {
    $scope.data = {bill: {}, ship: {}, ship_bill: 0, notes: '', shipping: 'free_shipping', gateway: 'stripe'}
    $scope.cart = cart;
    $scope.options = options;
    $scope.fields = fields;

    $scope.createOrder = function() {
      moltin.Cart.Complete({
        customer: '1069796748437750328', //guest customer for now
        shipping: $scope.data.shipping,
        gateway: $scope.data.gateway,
        bill_to: $scope.data.bill,
        ship_to: $scope.data.ship_bill ? 'bill_to' : $scope.data.ship
      }, function(response) {
        $rootScope.order = response;
        $rootScope.$apply(function() {
          $location.path('/payment');
        });
      })
    }
    console.log(cart);
    console.log(options);
    console.log(fields);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:CompleteCtrl
 * @description
 * # CompleteCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('CompleteCtrl', function ($scope) {
    $scope.awesomeThings = [
      'HTML5 Boilerplate',
      'AngularJS',
      'Karma'
    ];
    console.log($scope);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:MainCtrl
 * @description
 * # MainCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('MainCtrl', function ($scope, categories, features) {
    $scope.categories = categories;
    $scope.features = features;
    console.log(features);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:PaymentCtrl
 * @description
 * # PaymentCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('PaymentCtrl', function ($scope, $location, $rootScope, moltin) {
    $scope.payment = function(data) {
      moltin.Checkout.Payment('purchase', $scope.order.id, {data: $scope.data}, function(response) {
        $rootScope.order = $rootScope.cart = null;
        $rootScope.payment = response;
        $rootScope.$apply(function() {
          $location.path('/complete');
        });
      });
    }
    console.log($rootScope);
  });

'use strict';

/**
 * @ngdoc function
 * @name storefrontApp.controller:ProductCtrl
 * @description
 * # ProductCtrl
 * Controller of the storefrontApp
 */
angular.module('storefrontApp')
  .controller('ProductCtrl', function ($scope, $rootScope, product, moltin, $timeout) {
    $scope.product = product;
    $scope.addStatus = null;

    $scope.addCart = function() {
      $scope.addStatus = 'Adding to cart...';
      // Insert(id, qty, modifiers/size, callback)
      moltin.Cart.Insert(product.id, 1, null, function(cart) {
        $scope.addStatus = 'Success!';
        moltin.Cart.Contents(function(items) {
          $rootScope.cart = items;
          $rootScope.$apply();
        });
        $scope.$apply();
        $timeout(function() {
          $scope.addStatus = null;
        }, 1000);
      });
    }
    console.log(product);
  });
